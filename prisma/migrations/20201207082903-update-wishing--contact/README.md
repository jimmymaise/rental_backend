# Migration `20201207082903-update-wishing--contact`

This migration has been generated by Phat Tran at 12/7/2020, 3:29:03 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
Begin;
CREATE TYPE "public"."ItemStatus_new" AS ENUM ('Draft', 'Blocked', 'Published');
ALTER TABLE "public"."Item" ALTER COLUMN "status" TYPE "ItemStatus_new" USING ("status"::text::"ItemStatus_new");
ALTER TYPE "ItemStatus" RENAME TO "ItemStatus_old";
ALTER TYPE "ItemStatus_new" RENAME TO "ItemStatus";
DROP TYPE "ItemStatus_old";
Commit

ALTER TABLE "public"."WishingItemList" DROP CONSTRAINT "WishingItemList_itemId_fkey"

CREATE TABLE "public"."WishingItem" (
"id" text   NOT NULL ,
"ownerUserId" text   NOT NULL ,
"itemId" text   NOT NULL ,
"createdDate" timestamp(3)   NOT NULL DEFAULT CURRENT_TIMESTAMP,
PRIMARY KEY ("id")
)

CREATE TABLE "public"."MyUserContactItem" (
"id" text   NOT NULL ,
"ownerUserId" text   NOT NULL ,
"userId" text   NOT NULL ,
"createdDate" timestamp(3)   NOT NULL DEFAULT CURRENT_TIMESTAMP,
PRIMARY KEY ("id")
)

DROP TABLE "public"."MyUserContactList"

DROP TABLE "public"."WishingItemList"

CREATE INDEX "file_storage_main_index" ON "public"."FileStorage"("bucketName", "isUploadSuccess", "isDeleted", "createdBy")

ALTER TABLE "public"."WishingItem" ADD FOREIGN KEY("itemId")REFERENCES "public"."Item"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."MyUserContactItem" ADD FOREIGN KEY("userId")REFERENCES "public"."User"("id") ON DELETE CASCADE ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20201202130029-storagfe..20201207082903-update-wishing--contact
--- datamodel.dml
+++ datamodel.dml
@@ -2,9 +2,9 @@
 // learn more about it in the docs: https://pris.ly/d/prisma-schema
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url = "***"
 }
 generator client {
   provider = "prisma-client-js"
@@ -81,9 +81,8 @@
 enum ItemStatus {
   Draft
   Blocked
-  Rejected
   Published
 }
 // areas, FE will use the last area, it's smallest unit
@@ -233,20 +232,22 @@
   type              UserNotificationType
   isRead          Boolean?        @default(false)
 }
-model WishingItemList {
+model WishingItem {
   id      String          @id @default(uuid())
   ownerUserId             String
   item           Item @relation(fields: [itemId], references: [id])
   itemId          String
   createdDate             DateTime        @default(now())
 }
-model MyUserContactList {
+model MyUserContactItem {
   id      String          @id @default(uuid())
   ownerUserId             String
+  user           User @relation(fields: [userId], references: [id])
   userId                  String
+  createdDate             DateTime        @default(now())
 }
 // Item Reviews?
 // Renting Request Comments? with attach files
```


