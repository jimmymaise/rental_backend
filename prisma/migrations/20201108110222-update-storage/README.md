# Migration `20201108110222-update-storage`

This migration has been generated by Phat Tran at 11/8/2020, 6:02:22 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TYPE "public"."FileUsingLocate" AS ENUM ('ItemPreviewImage', 'UserAvatarImage', 'UserCoverImage')

ALTER TABLE "public"."FileStorage" DROP COLUMN "thumbnailMap",
ADD COLUMN "usingLocate" "FileUsingLocate"  ,
ADD COLUMN "thumbnailUrl" text   
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20201107141035-update-user..20201108110222-update-storage
--- datamodel.dml
+++ datamodel.dml
@@ -2,9 +2,9 @@
 // learn more about it in the docs: https://pris.ly/d/prisma-schema
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url = "***"
 }
 generator client {
   provider = "prisma-client-js"
@@ -53,19 +53,26 @@
   isDeleted         Boolean?    @default(false)
   items             Item[]      @relation(references: [id])
 }
+enum FileUsingLocate {
+  ItemPreviewImage
+  UserAvatarImage
+  UserCoverImage
+}
+
 model FileStorage {
   id                String        @id @default(uuid())
   url               String
   name              String
   bucketName        String
   folderName        String
   contentType       String
+  usingLocate       FileUsingLocate?
   createdBy         String
   createdDate       DateTime      @default(now())
   isDeleted         Boolean?      @default(false)
-  thumbnailMap      Json? // { 300: { id, url, name, bucketName, folderName } }
+  thumbnailUrl      String?
 }
 enum ItemStatus {
   Draft
@@ -114,9 +121,8 @@
 // Luu danh ba nguoi cho thue
 // User Notifications
 // Log user sharing
-
 enum RentingItemRequestStatus {
   Declined
   Approved
   InProgress
```


